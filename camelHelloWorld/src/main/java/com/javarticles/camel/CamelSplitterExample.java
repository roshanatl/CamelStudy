package com.javarticles.camel;

import java.util.ArrayList;
import java.util.List;

import org.apache.camel.CamelContext;
import org.apache.camel.Exchange;
import org.apache.camel.Processor;
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.impl.DefaultCamelContext;
import org.apache.camel.util.jndi.JndiContext;

public class CamelSplitterExample {
	public static final void main(String[] args) throws Exception {
	    JndiContext jndiContext = new JndiContext();
	    jndiContext.bind("processOrderItem", new OrderItemProcessor());
	    jndiContext.bind("mySplitterBean", new SplitterBean());
	    jndiContext.bind("MyAggregationStrategy", new MyAggregationStrategy());
        CamelContext camelContext = new DefaultCamelContext(jndiContext);
        try {
            camelContext.addRoutes(new RouteBuilder() {
                public void configure() {
                    from("timer://generateOrders?fixedRate=true&period=10000")
                    .log("Generate order items")
                    .process(new Processor() {
                        
                        public void process(Exchange exchange) throws Exception {
                            Order order = new Order(1);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            order.addItem("Coke", 20, 2);
                            order.addItem("Banana", 12, 1);
                            order.addItem("Tab", 5, 250);
                            order.addItem("Milk", 40, 10);
                            order.addItem("Pepsi", 20, 2);
                            order.addItem("orange", 12, 1);
                            order.addItem("candy", 5, 250);
                            order.addItem("sugar", 40, 10);
                            
                            exchange.getIn().setBody(order);
                        }
                    })
                    .to("direct:processOrder");
                    
                    from("direct:processOrder")
                    .log("Process order ${body}")
                    
                    .process(new Processor() {
						
						public void process(Exchange exchange) throws Exception {
							System.out.println( "Start :"+ System.currentTimeMillis());
							int orderSpiltCount = 0;
							final int orderBatchSize = 10;
							Order order = exchange.getIn().getBody(Order.class);
							List<List<OrderItem>> listOfListOfSmallOrders = new ArrayList<List<OrderItem>>();
							int Start = orderSpiltCount * orderBatchSize;
							int end ;
							int size= order.getItems().size();
							while (size > Start) {
								List<OrderItem> smallOrders = new ArrayList<OrderItem>();
								end = Start + orderBatchSize;
								if (end>size)
								{
									end=size;
								}
								smallOrders = order.getItems().subList(Start, end);
								orderSpiltCount++;
								listOfListOfSmallOrders.add(smallOrders);
								Start = orderSpiltCount * orderBatchSize;
							}
							System.out.println("Splitted Orders : " + listOfListOfSmallOrders);
							exchange.getIn().setBody(listOfListOfSmallOrders);
						}
					})
                    
                    .split(body(), new MyAggregationStrategy())
                   //.parallelProcessing()
                    .to("direct:processOrderItem")                    
                    .end()
                    .log("Order processed: ${body.size}")
                    .process(new Processor() {
						
						public void process(Exchange exchange) throws Exception {
							System.out.println( "Done :"+ System.currentTimeMillis());
							
						}
					});
                    
                   
                    
                    
                    from("direct:processOrderItem")                           
                    .log("processing  items ${body}")
                    .to("bean:processOrderItem");
                    
                }
            });
            camelContext.start();
            Thread.sleep(5000);
        } finally {
            camelContext.stop();
        }
	}
}
